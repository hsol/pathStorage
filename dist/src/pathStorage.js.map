{"version":3,"sources":["../../src/pathStorage.js"],"names":["PathStorage","options","config","Object","assign","autoExecute","useHashPath","realTimePath","window","location","Location","Error","constructor","name","workSpace","load","localHashKey","undefined","pathKey","hashKey","path","map","char","charCodeAt","join","hashPath","isNaN","pathname","split","hash","substr","shift","generateLocalKey","assertLocalHashKey","pastKey","detectPath","localStorage","setItem","JSON","stringify","parse","getItem","length","keys","assertWorkSpace","key","index","hasOwnProperty","execute","value"],"mappings":"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","file":"pathStorage.js","sourcesContent":["'use strict';\r\n\r\nclass PathStorage {\r\n  constructor(options) {\r\n    this.config = Object.assign((this.config || {\r\n      autoExecute: true,\r\n      useHashPath: false,\r\n      realTimePath: false,\r\n    }), (options || {}));\r\n\r\n    if (!window.location instanceof Location) {\r\n      throw new Error(`${this.constructor.name} must use on browser environment.`);\r\n    }\r\n\r\n    this.workSpace = {};\r\n\r\n    this.load();\r\n  }\r\n\r\n  assertLocalHashKey() {\r\n    if (this.localHashKey === undefined) {\r\n      throw new Error(`${this.constructor.name} has not key.`);\r\n    }\r\n  }\r\n\r\n  assertWorkSpace() {\r\n    if (this.workSpace === undefined) {\r\n      throw new Error(`${this.constructor.name} has not workspace.`);\r\n    }\r\n  }\r\n\r\n  generateLocalKey() {\r\n    let pathKey, hashKey;\r\n    pathKey = this.path\r\n    .map((char) => {\r\n      return char.charCodeAt(0);\r\n    }).join('');\r\n\r\n    if(this.config.useHashPath) {\r\n      hashKey = this.hashPath\r\n      .map((char) => {\r\n        return char.charCodeAt(0);\r\n      }).join('');\r\n      pathKey = (isNaN(pathKey) ? '' : pathKey) + (isNaN(hashKey) ? '' : hashKey);\r\n    }\r\n\r\n    return pathKey;\r\n  }\r\n\r\n  detectPath() {\r\n    this.path = window.location.pathname.split('/');\r\n    this.hashPath = (window.location.hash.substr(1)).split('/');\r\n\r\n    this.path.shift();\r\n\r\n    this.localHashKey = this.generateLocalKey();\r\n    this.assertLocalHashKey();\r\n  }\r\n\r\n  load() {\r\n    let pastKey = this.localHashKey;\r\n    this.detectPath();\r\n\r\n    if(pastKey !== undefined && pastKey !== this.localHashKey) {\r\n      localStorage.setItem(pastKey, JSON.stringify(this.workSpace));\r\n    }\r\n\r\n    if (localStorage[this.localHashKey] === undefined) {\r\n      localStorage.setItem(this.localHashKey, JSON.stringify({}));\r\n    }\r\n\r\n    this.workSpace = JSON.parse(localStorage.getItem(this.localHashKey)) || {};\r\n  }\r\n\r\n  execute() {\r\n    if (this.config.realTimePath) {\r\n      this.detectPath();\r\n    }\r\n\r\n    localStorage.setItem(this.localHashKey, JSON.stringify(this.workSpace));\r\n    this.length = Object.keys(this.workSpace).length;\r\n  }\r\n\r\n  clear() {\r\n    this.assertWorkSpace();\r\n\r\n    this.workSpace = {};\r\n    localStorage.setItem(this.localHashKey, null);\r\n  };\r\n\r\n  getItem(key) {\r\n    if (this.config.realTimePath) {\r\n      this.load();\r\n    }\r\n\r\n    return this.workSpace[key];\r\n  };\r\n\r\n  key(index) {\r\n    let keys;\r\n    if (this.config.realTimePath) {\r\n      this.load();\r\n    }\r\n    keys = Object.keys(this.workSpace);\r\n\r\n    return this.workSpace[keys[index]];\r\n  };\r\n\r\n  removeItem(key) {\r\n    if (this.config.realTimePath) {\r\n      this.load();\r\n    }\r\n\r\n    if (this.workSpace.hasOwnProperty(key)) {\r\n      delete this.workSpace[key];\r\n    }\r\n\r\n    if(this.config.autoExecute) {\r\n      this.execute();\r\n    }\r\n  };\r\n\r\n  setItem(key, value) {\r\n    if (this.config.realTimePath) {\r\n      this.load();\r\n    }\r\n\r\n    this.workSpace[key] = value;\r\n\r\n    if(this.config.autoExecute) {\r\n      this.execute();\r\n    }\r\n  };\r\n}\r\n"]}